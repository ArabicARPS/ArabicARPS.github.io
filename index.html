<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <title>Ù„Ø¹Ø¨Ø© Ø§Ù„Ø«Ø¹Ø¨Ø§Ù†</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background: #111;
      color: #f5f5f5;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }

    h1 {
      margin-bottom: 10px;
      text-align: center;
    }

    #game-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }

    canvas {
      border: 2px solid #444;
      background: #000;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.8);
    }

    #info {
      font-size: 14px;
      text-align: center;
      opacity: 0.8;
      line-height: 1.6;
    }

    #score {
      font-size: 16px;
      font-weight: bold;
    }

    .btn {
      padding: 6px 14px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-size: 14px;
      background: #2b8a3e;
      color: #fff;
    }

    .btn:hover {
      filter: brightness(1.1);
    }
  </style>
</head>
<body>
  <h1>Ù„Ø¹Ø¨Ø© Ø§Ù„Ø«Ø¹Ø¨Ø§Ù† ğŸ</h1>

  <div id="game-container">
    <canvas id="game" width="400" height="400"></canvas>
    <div id="score">Ø§Ù„Ù†ØªÙŠØ¬Ø©: 0</div>
    <div id="info">
      ØªØ­ÙƒÙ…: Ø§Ù„Ø£Ø³Ù‡Ù… â¬…ï¸ â¬†ï¸ â¬‡ï¸ â¡ï¸<br />
      Ù…Ø³Ø§ÙØ© (Space) Ù„Ù„Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¤Ù‚Øª / Ø§Ù„Ø§Ø³ØªÙƒÙ…Ø§Ù„<br />
      Ø§Ø¶ØºØ· "Ø¥Ø¹Ø§Ø¯Ø© Ø¨Ø¯Ø¡" Ù„Ø¨Ø¯Ø¡ Ù„Ø¹Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©
    </div>
    <button class="btn" id="restart">Ø¥Ø¹Ø§Ø¯Ø© Ø¨Ø¯Ø¡</button>
  </div>

  <script>
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");
    const scoreEl = document.getElementById("score");
    const restartBtn = document.getElementById("restart");

    const box = 20; // Ø­Ø¬Ù… Ø§Ù„Ø®Ù„ÙŠØ© (Ù…Ø±Ø¨Ø¹Ø§Øª Ø§Ù„Ø´Ø¨ÙƒØ©)
    let snake;
    let direction;
    let food;
    let score;
    let gameOver;
    let isPaused;
    let gameLoopId;

    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
    function initGame() {
      snake = [{ x: 9 * box, y: 9 * box }]; // Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø«Ø¹Ø¨Ø§Ù† ÙÙŠ Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙˆØ­Ø© ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹
      direction = "RIGHT";
      score = 0;
      gameOver = false;
      isPaused = false;
      food = randomFood();
      updateScore();
      if (gameLoopId) clearInterval(gameLoopId);
      gameLoopId = setInterval(loop, 120); // Ø³Ø±Ø¹Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© (ÙƒÙ„Ù…Ø§ Ù‚Ù„Ù‘ Ø§Ù„Ø±Ù‚Ù… Ø²Ø§Ø¯Øª Ø§Ù„Ø³Ø±Ø¹Ø©)
    }

    // ØªÙˆÙ„ÙŠØ¯ Ø·Ø¹Ø§Ù… ÙÙŠ Ù…ÙƒØ§Ù† Ø¹Ø´ÙˆØ§Ø¦ÙŠ
    function randomFood() {
      const maxCells = canvas.width / box;
      return {
        x: Math.floor(Math.random() * maxCells) * box,
        y: Math.floor(Math.random() * maxCells) * box,
      };
    }

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø©
    function updateScore() {
      scoreEl.textContent = "Ø§Ù„Ù†ØªÙŠØ¬Ø©: " + score;
    }

    // Ø±Ø³Ù… Ø§Ù„Ø®Ù„ÙÙŠØ© ÙˆØ§Ù„Ø´Ø¨ÙƒØ©
    function drawBoard() {
      ctx.fillStyle = "#000";
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      ctx.strokeStyle = "#222";
      for (let x = 0; x <= canvas.width; x += box) {
        ctx.beginPath();
        ctx.moveTo(x, 0);
        ctx.lineTo(x, canvas.height);
        ctx.stroke();
      }
      for (let y = 0; y <= canvas.height; y += box) {
        ctx.beginPath();
        ctx.moveTo(0, y);
        ctx.lineTo(canvas.width, y);
        ctx.stroke();
      }
    }

    // Ø±Ø³Ù… Ø§Ù„Ø«Ø¹Ø¨Ø§Ù†
    function drawSnake() {
      for (let i = 0; i < snake.length; i++) {
        ctx.fillStyle = i === 0 ? "#4caf50" : "#81c784"; // Ø§Ù„Ø±Ø£Ø³ Ø£ØºÙ…Ù‚
        ctx.fillRect(snake[i].x, snake[i].y, box, box);

        ctx.strokeStyle = "#000";
        ctx.strokeRect(snake[i].x, snake[i].y, box, box);
      }
    }

    // Ø±Ø³Ù… Ø§Ù„Ø·Ø¹Ø§Ù…
    function drawFood() {
      ctx.fillStyle = "#e53935";
      ctx.fillRect(food.x, food.y, box, box);
    }

    // ÙƒØ´Ù Ø§Ù„ØªØµØ§Ø¯Ù… Ù…Ø¹ Ø§Ù„Ø¬Ø³Ù…
    function collisionWithSelf(head, array) {
      return array.some(
        (segment) => segment.x === head.x && segment.y === head.y
      );
    }

    // Ø®Ø·ÙˆØ© ÙˆØ§Ø­Ø¯Ø© Ù…Ù† Ø§Ù„Ù„Ø¹Ø¨Ø© (ØªØ­Ø¯ÙŠØ« + Ø±Ø³Ù…)
    function loop() {
      drawBoard();
      drawFood();
      drawSnake();

      if (gameOver) {
        ctx.fillStyle = "#fff";
        ctx.font = "24px sans-serif";
        ctx.textAlign = "center";
        ctx.fillText("Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©! Ø§Ø¶ØºØ· Ø¥Ø¹Ø§Ø¯Ø© Ø¨Ø¯Ø¡", canvas.width / 2, canvas.height / 2);
        return;
      }

      if (isPaused) {
        ctx.fillStyle = "#fff";
        ctx.font = "20px sans-serif";
        ctx.textAlign = "center";
        ctx.fillText("Ù…ØªÙˆÙ‚Ù Ù…Ø¤Ù‚ØªØ§Ù‹", canvas.width / 2, canvas.height / 2);
        return;
      }

      // Ø­Ø³Ø§Ø¨ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø£Ø³ Ø§Ù„Ø¬Ø¯ÙŠØ¯
      let head = { ...snake[0] };

      if (direction === "LEFT") head.x -= box;
      if (direction === "UP") head.y -= box;
      if (direction === "RIGHT") head.x += box;
      if (direction === "DOWN") head.y += box;

      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØµØ·Ø¯Ø§Ù… Ø¨Ø§Ù„Ø¬Ø¯Ø±Ø§Ù†
      if (
        head.x < 0 ||
        head.x >= canvas.width ||
        head.y < 0 ||
        head.y >= canvas.height
      ) {
        gameOver = true;
        return;
      }

      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØµØ·Ø¯Ø§Ù… Ø¨Ø§Ù„Ø¬Ø³Ù…
      if (collisionWithSelf(head, snake)) {
        gameOver = true;
        return;
      }

      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£ÙƒÙ„ Ø§Ù„Ø·Ø¹Ø§Ù…
      if (head.x === food.x && head.y === food.y) {
        score++;
        updateScore();
        food = randomFood();
        // Ù„Ø§ Ù†Ø­Ø°Ù Ø§Ù„Ø°ÙŠÙ„ Ù‡Ù†Ø§ Ø­ØªÙ‰ ÙŠØ·ÙˆÙ„ Ø§Ù„Ø«Ø¹Ø¨Ø§Ù†
      } else {
        // ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø«Ø¹Ø¨Ø§Ù†: Ø¥Ø¶Ø§ÙØ© Ø±Ø£Ø³ Ø¬Ø¯ÙŠØ¯ ÙˆØ­Ø°Ù Ø§Ù„Ø°ÙŠÙ„
        snake.pop();
      }

      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø£Ø³ ÙÙŠ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù…ØµÙÙˆÙØ©
      snake.unshift(head);
    }

    // ØªØºÙŠÙŠØ± Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
    document.addEventListener("keydown", function (e) {
      const key = e.key;

      if (key === "ArrowLeft" && direction !== "RIGHT") direction = "LEFT";
      else if (key === "ArrowUp" && direction !== "DOWN") direction = "UP";
      else if (key === "ArrowRight" && direction !== "LEFT") direction = "RIGHT";
      else if (key === "ArrowDown" && direction !== "UP") direction = "DOWN";
      else if (key === " " || key === "Spacebar") {
        // Ø¥ÙŠÙ‚Ø§Ù/Ø§Ø³ØªÙƒÙ…Ø§Ù„
        isPaused = !isPaused;
      }
    });

    // Ø²Ø± Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¨Ø¯Ø¡
    restartBtn.addEventListener("click", function () {
      initGame();
    });

    // Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    initGame();
  </script>
</body>
</html>
